# Contributing Guide

This documentation is _NOT_ intended to be comprehensive; it is meant to be a quick guide for the most useful things.

## Code of Conduct

The Metis SDK adheres to the [Rust Code of Conduct](https://www.rust-lang.org/conduct.html). This code of conduct describes the minimum behavior expected from all contributors.

## System Requirements

The following hardware is recommended.

- 20GB+ of free disk space.
- 8GB+ RAM
- 4+ cores

## Dependencies

- `git`
- `Rust 1.85+`
- `LLVM 18` (optional, if you enable the `compiler` feature, you can reference the [document](../crates/vm/docs/dev.md) to install it)

## Building

In the top level of the repo and run

```shell
make build
```

## Linting

In the top level of the repo and run

```shell
make clippy
# or run `make clippy-all` for all features
```

## Formatting

In the top level of the repo and run

```shell
make fmt
```

## Testing

### Unit Testing

In the top level of the repo and run

```shell
make test
# or run `make test-all` for all features
```

### Benchmark

See [here](../crates/pe/benches/README.md) for more information.

## Asking for Help

You can get help by *opening a discussion*. This repository comes with a discussions board where you can also ask for help. Click the *Discussions* tab at the top.

## Submitting a Bug Report

Before submitting an issue, please check the closed issue. There may already be an appropriate solution in the closed issue. You can submit an issue on GitHub for the bug report. Please include:

- Detailed description of the unexpected behavior
- Steps to reproduce the issue
- Environment information (OS version, Rust version, etc.)
- Relevant error logs or screenshots
- Expected vs actual behavior

## Submitting a Pull Request (PR)

- Fork the repository and create your branch from main
- Ensure your code passes all Rust tests and lint checks
- Update documentation if needed
- Include relevant test cases
- Reference related issues in your PR description
- Use clear commit messages (see Git Commit Guide below)
- Wait for CI pipeline to pass
- Address review comments promptly

## Git Commit Guide

### About Git Branch

To contribute code or documents to Metis SDK, you must have a GitHub account so that you can push the code to your own branch and create pull requests. We recommend reference the following spec and name your own branches.

The recommended format is as follows:

```text
{type}-{a_short_description}
```

The branch name mainly includes two fields, which are separated by "-". Including:

- `{type}`: the type of the current branch content.
- `{a_short_description}`: A short description of the main content of this branch.

### About Git Commit

We refer to [Commitizen](https://github.com/commitizen/cz-cli) to write a Commit Message.

```text
Note: If you directly use Commit to generate a Commit Message, please note that
It is a tool for developers to manage commit. It is not related to the project itself, so it is an intermediate product generated by Commiten
(For example, the node_modules file directory) may not be in the project. gitignore file.

You can git add {filename} select the file to submit and ignore the intermediate product.
Or you can add the following content to the. gitignore file and automatically ignore the intermediate products:
# commitizen
package.json
package-lock.json
node_modules/*
```

If you manually write a commit Message, we also recommend Commiten for the commit message format.

```text
{type} ( {component_or_file} ) {a_short_description}
{a_longer_description}
BREAKING CHANGE: {breaking_change_description}.
{linked issue}
```

It mainly includes 6 fields:

- `{type}`: the type of the branch corresponding to the current commit.
- `{component_or_file}`: the name of the module or file that the current commit changes.
- `{a_short_description}`: A short description describes the content of the commit.
- `{a_longer_description}`: The detailed description is used to introduce the content in the commit.
- `{breaking_change_description}`: If the commit contains broken compatibility changes, the impact of compatibility changes needs to be introduced.
- `{linked issue}`: the issue associated with the current commit.

Where `{breaking_change_description}` and `{linked issue}` can be omitted if the commit does not contain compatibility breaking changes and associated issues.

For example, the commit created by Alice in branch `fix-metis-pe-output-format-bug`.

```text
fix(metis-pe): fix an output format bug in metis-pe crate.

There is an output format bug in the metis-pe crate because ...,
So, The calling of method "XXX" is replaced by "HHHH"...,
...

--If there is no change to break the compatibility and the associated issue, the following contents can be omitted.
BREAKING CHANGE: This change maybe cause .......

fix #123
```

### About Pull Request

We suggest that the PR title be consistent with the branch name and the commit message style:

```text
{type} ( {component_name_or_file_name} ) :{a_short_description}
```

For example, Alice creates the PR name `fix-metis-pe-output-format-bug` for one branch.

```text
fix(metis-pe): fix an output format bug in metis-pe crate.
```

### Supported PR Types

```text
- feat: -- New features have been added.
- fix: -- Bug is repaired.
- docs: -- The document part has been modified.
- style: -- The modification of code format does not affect the functions of the code, such as deleting redundant spaces, code indentation, etc.
- refactor: -- refactoring code without changing its function.
- perf: -- Performs performance optimization on the code.
- test: -- Add or adjust existing test cases.
- build: -- Adjust the build system or external dependent libraries.
- ci: -- The configuration file or script of the CI has been adjusted.
- choice: -- Adjustments to other parts of the source code and test files.
- reverse: -- Rollback commit.
```
